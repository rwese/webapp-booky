# Production Environment Configuration for Booky Backend
# File: backend/.env.production
# IMPORTANT: This file contains sensitive credentials. Never commit to version control!

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================
NODE_ENV=production
PORT=3001
APP_URL=https://api.booky.app
VERSION=1.0.0

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# PostgreSQL connection string (ensure SSL is enabled in production)
DATABASE_URL=postgresql://username:password@hostname:5432/booky_production?sslmode=require

# Database connection pool settings
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10
DATABASE_CONNECTION_TIMEOUT=30000

# =============================================================================
# AUTHENTICATION & SECURITY
# =============================================================================
# Generate a strong random secret (at least 32 characters)
AUTH_SECRET=your-super-secret-jwt-key-minimum-32-characters-long

# JWT token expiration times
AUTH_JWT_EXPIRES_IN=30d
AUTH_REFRESH_TOKEN_EXPIRES_IN=60d
AUTH_VERIFICATION_TOKEN_EXPIRES_IN=24h
AUTH_PASSWORD_RESET_EXPIRES_IN=1h

# Password hashing
AUTH_BCRYPT_ROUNDS=12

# Session configuration
SESSION_SECRET=your-session-secret-key
SESSION_MAX_AGE=86400000  # 24 hours in milliseconds

# =============================================================================
# STORAGE CONFIGURATION
# =============================================================================
# Storage backend type: local, s3, gcs, azure
STORAGE_TYPE=s3

# Local storage path (if STORAGE_TYPE=local)
STORAGE_PATH=/app/storage
STORAGE_MAX_SIZE=10485760  # 10MB in bytes

# AWS S3 Configuration (if STORAGE_TYPE=s3)
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=your-aws-access-key-id
AWS_SECRET_ACCESS_KEY=your-aws-secret-access-key
AWS_S3_BUCKET=booky-production
AWS_S3_ENDPOINT=https://s3.amazonaws.com
AWS_S3_FORCE_PATH_STYLE=false

# =============================================================================
# CDN CONFIGURATION
# =============================================================================
CDN_URL=https://cdn.booky.app
CDN_ENABLED=true
CDN_API_TOKEN=your-cdn-api-token

# =============================================================================
# RATE LIMITING
# =============================================================================
RATE_LIMIT_WINDOW_MS=900000  # 15 minutes
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_AUTH_MAX_REQUESTS=10
RATE_LIMIT_SEARCH_MAX_REQUESTS=30

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================
# Log level: error, warn, info, debug, verbose
LOG_LEVEL=info
LOG_FORMAT=json
LOG_PRETTY=false

# Sentry error tracking (optional)
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=production
SENTRY_RELEASE=1.0.0
SENTRY_TRACES_SAMPLE_RATE=0.1

# =============================================================================
# EXTERNAL API KEYS
# =============================================================================
# Google Books API (optional - for ISBN lookup)
GOOGLE_BOOKS_API_KEY=your-google-books-api-key

# =============================================================================
# EMAIL CONFIGURATION (for password reset, etc.)
# =============================================================================
# SMTP settings for email delivery
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-smtp-user
SMTP_PASSWORD=your-smtp-password
EMAIL_FROM=noreply@booky.app
EMAIL_FROM_NAME=Booky

# Or use a transaction email service
EMAIL_PROVIDER=sendgrid  # sendgrid, mailgun, sesSENDGRID_API_KEY=your-sendgrid-api-key
SENDGRID_FROM_EMAIL=n
oreply@booky.app

# =============================================================================
# OAUTH CONFIGURATION (optional)
# =============================================================================
# Google OAuth
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_CALLBACK_URL=https://api.booky.app/api/auth/oauth/google

# GitHub OAuth
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret
GITHUB_CALLBACK_URL=https://api.booky.app/api/auth/oauth/github

# =============================================================================
# CORS & SECURITY
# =============================================================================
# Allowed origins for CORS (comma-separated)
CORS_ORIGINS=https://booky.app,https://www.booky.app,http://localhost:3000

# Security headers
SECURITY_HSTS_MAX_AGE=31536000
SECURITY_HSTS_INCLUDE_SUBDOMAINS=true
SECURITY_HSTS_PRELOAD=false

# =============================================================================
# SYNC CONFIGURATION
# =============================================================================
# Sync operation limits
SYNC_MAX_OPERATIONS_PER_BATCH=100
SYNC_MAX_BODY_SIZE=5242880  # 5MB in bytes
SYNC_OPERATION_TIMEOUT=30000  # 30 seconds

# =============================================================================
# FILE UPLOAD LIMITS
# =============================================================================
MAX_FILE_SIZE=10485760  # 10MB
MAX_COVER_SIZE=5242880  # 5MB for cover images
MAX_AVATAR_SIZE=2097152  # 2MB for user avatars
ALLOWED_IMAGE_TYPES=image/jpeg,image/png,image/gif,image/webp

# =============================================================================
# FEATURE FLAGS
# =============================================================================
FEATURE_OAUTH_ENABLED=true
FEATURE_PASSWORDLESS_ENABLED=false
FEATURE_2FA_ENABLED=false
FEATURE_IMPORT_EXPORT_ENABLED=true

# =============================================================================
# REDIS (for rate limiting and caching - optional)
# =============================================================================
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=your-redis-password

# =============================================================================
# METRICS & HEALTH CHECKS
# =============================================================================
METRICS_ENABLED=true
METRICS_PORT=9090
HEALTH_CHECK_TOKEN=your-health-check-token
